# Vertex Fetching in HLSL (xvs_3_0, xps_3_0)

**Source:** http://msdn.microsoft.com/en-us/library/bb313874.aspx

The Wayback Machine - https://web.archive.org/web/20100423061946/http://msdn.microsoft.com:80/en-us/library/bb313874.aspx
XNA Game Studio 3.1
Vertex Fetching in HLSL (xvs_3_0, xps_3_0)
Vertex fetching in HLSL is implemented by using a combination of the INDEX input semantic and an **asm** block that uses a [vfetch](https://web.archive.org/web/20100423061946/http://msdn.microsoft.com/en-us/library/bb313960.aspx) instruction. 
The following HLSL code shows how vertex fetching can be used to implement an alternative to [SetFrequency](https://web.archive.org/web/20100423061946/http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.graphics.vertexstream.setfrequency.aspx). Note that the INDEX input semantic is associated with a parameter of type **int**. 
```
    float instanceSize : register( c0 ); // Set by application code.
    
    struct vsout {
      float4 p : POSITION;
      float4 c : COLOR;
    };
    
    float4 fetchPosition( int index )
    {
      float4 pos;
      asm {
        vfetch pos, index, position
      };
      return pos;
    }
    
    float4 fetchDelta( int index )
    {
      float4 pos;
      asm {
        vfetch pos, index, position1
      };
      return pos;
    }

    float4 fetchColor( int index )
    {
      float4 color;
      asm {
        vfetch color, index, color
      };
      return color;
    }
    
    vsout main( int i : INDEX )
    {
      vsout output;
      
      // Add 0.5 before dividing to avoid rounding errors.
      int outerIndex = (i + 0.5) / instanceSize;
      
      int innerIndex = i - outerIndex * instanceSize;
      output.p = fetchPosition( innerIndex ) + fetchDelta( outerIndex );
      output.c = fetchColor( outerIndex );
      return output;
    }
  
```

See Also
* * *
#### Concepts
[Inline Microcode Assembly in HLSL](https://web.archive.org/web/20100423061946/http://msdn.microsoft.com/en-us/library/bb313871.aspx)  
[Texture Fetching in HLSL (xvs_3_0, xps_3_0)](https://web.archive.org/web/20100423061946/http://msdn.microsoft.com/en-us/library/bb313873.aspx)  
[Swizzling (xvs_3_0, xps_3_0)](https://web.archive.org/web/20100423061946/http://msdn.microsoft.com/en-us/library/bb313962.aspx)  

#### Reference
[Microcode Instructions (xvs_3_0, xps_3_0)](https://web.archive.org/web/20100423061946/http://msdn.microsoft.com/en-us/library/bb313961.aspx)  

* * *
  
[MSDN Library](https://web.archive.org/web/20100423061946/http://msdn.microsoft.com/en-us/library/ms123401.aspx)  
[Development Tools and Languages](https://web.archive.org/web/20100423061946/http://msdn.microsoft.com/en-us/library/aa187916.aspx)  
[XNA Game Studio](https://web.archive.org/web/20100423061946/http://msdn.microsoft.com/en-us/library/aa468128.aspx)  
[XNA Game Studio 3.1](https://web.archive.org/web/20100423061946/http://msdn.microsoft.com/en-us/library/bb200104.aspx)  
[Programming Guide](https://web.archive.org/web/20100423061946/http://msdn.microsoft.com/en-us/library/bb198548.aspx)  
[Hardware and Platforms](https://web.archive.org/web/20100423061946/http://msdn.microsoft.com/en-us/library/bb975657.aspx)  
[Xbox 360 Programming](https://web.archive.org/web/20100423061946/http://msdn.microsoft.com/en-us/library/bb417501.aspx)  
[Microcode (xvs_3_0, xps_3_0)](https://web.archive.org/web/20100423061946/http://msdn.microsoft.com/en-us/library/bb313877.aspx)  
[Vertex Fetching in HLSL (xvs_3_0, xps_3_0)](https://web.archive.org/web/20100423061946/http://msdn.microsoft.com/en-us/library/bb313874.aspx)
* * *
Tags: 
![](https://web.archive.org/web/20100423061946im_/http://i.msdn.microsoft.com/Global/Images/wiki.gif)
Community Content
